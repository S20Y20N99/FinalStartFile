<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.mvc.IMainDAO">

	<select id="getStoreList" resultType="com.test.mvc.GradeDTO">
		SELECT T.ST_NUM AS ST_NUM, T.ST_NAME AS ST_NAME, T.PHOTO_LINK AS PHOTO_LINK
		    , AVG(STAR_SCORE) OVER (PARTITION BY T.ST_NUM) AS STAR_SCORE, COUNT(*) OVER (PARTITION BY T.ST_NUM)
		FROM
		(
		    SELECT ST.ST_NUM AS ST_NUM, IA.ST_NAME AS ST_NAME, P.PHOTO_LINK AS PHOTO_LINK
		        , R.STAR_SCORE AS STAR_SCORE
		    FROM ST_LIST ST JOIN IN_PROCESS IP
		    ON ST.IN_PROCESS_NUM = IP.IN_PROCESS_NUM 
		    JOIN IN_APPLY IA
		    ON IP.IN_APPLY_NUM = IA.IN_APPLY_NUM
		    JOIN RV_BOX R
		    ON R.ST_NUM = ST.ST_NUM
		    JOIN ST_PHOTO P
		    ON ST.ST_NUM = P.ST_NUM
		    JOIN MAIN_PHOTO MP
		    ON P.ST_PHOTO_NUM = MP.ST_PHOTO_NUM
		) T
	</select>
	
	<select id="getIbmatStNumber" resultType="java.lang.String">
		
	</select>

	<select id="getJjimStNumber" resultType="java.lang.String">
	
	</select>
	
	<select id="getHotStNumber" resultType="java.lang.String">
	
	</select>
	
	<select id="getStoreSearchList" resultType="com.test.mvc.GradeDTO">
	
	</select>

</mapper>